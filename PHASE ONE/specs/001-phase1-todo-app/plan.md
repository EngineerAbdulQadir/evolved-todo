# Implementation Plan: Phase 1 Complete Todo App

**Branch**: `001-phase1-todo-app` | **Date**: 2025-12-06 | **Spec**: All 10 feature specs
**Input**: Feature specifications from `/specs/001-phase1-todo-app/*/spec.md`

## Summary

This is the universal implementation plan for the Phase 1 Complete Todo CLI Application. The plan covers all 10 features across three levels:

- **Basic Level (1-5)**: Add, View, Update, Mark Complete, Delete Tasks
- **Intermediate Level (6-8)**: Priorities & Tags, Search & Filter, Sort Tasks
- **Advanced Level (9-10)**: Recurring Tasks, Due Dates & Reminders

The implementation uses Python 3.13+, UV package manager, in-memory storage (dictionaries/lists), and a modular architecture that separates models, services, and CLI layers.

## Technical Context

**Language/Version**: Python 3.13+ (mandatory per constitution)
**Primary Dependencies**:
- `typer` or `click` for CLI framework
- `python-dateutil` for date parsing (due dates, recurrence)
- `rich` for enhanced CLI output (optional, for visual indicators)

**Storage**: In-memory only (Python dictionaries, lists) - NO database or file I/O
**Testing**: pytest with pytest-cov (>90% coverage required)
**Type Checking**: mypy (strict mode)
**Linting**: ruff (check and format)
**Target Platform**: Cross-platform CLI (Windows, macOS, Linux)
**Project Type**: Single project CLI application
**Performance Goals**:
- All operations under 1 second for up to 1000 tasks
- Task list display under 3 seconds for 1000 tasks

**Constraints**:
- Single-user (no authentication)
- CLI only (no web interface)
- In-memory only (data lost on restart)
- No external services or network calls

**Scale/Scope**:
- Support up to 10,000 tasks in memory
- 10 features total

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| I. Spec-First Development | ✅ PASS | All 10 specs created and approved before planning |
| II. Test-First (TDD) | ✅ PLANNED | Tests will be written before implementation |
| III. YAGNI Principle | ✅ PASS | Only implementing 10 specified features |
| IV. Technology Stack | ✅ PASS | Python 3.13+, UV, in-memory, pytest, mypy, ruff |
| V. Clean Code & Modularity | ✅ PLANNED | Structure defined below |
| VI. Type Safety | ✅ PLANNED | Full type annotations, strict mypy |
| VII. Comprehensive Documentation | ✅ PLANNED | README, docstrings, architecture docs |
| VIII. Error Handling | ✅ PLANNED | Custom exceptions, input validation |

**Forbidden Items Checklist:**
- ❌ Database or file persistence → Using in-memory only ✅
- ❌ User authentication → Single-user CLI ✅
- ❌ Web interface → CLI only ✅
- ❌ Features beyond 10-feature list → Strict scope adherence ✅

## Project Structure

### Documentation (this feature set)

```text
specs/001-phase1-todo-app/
├── plan.md              # This file (universal implementation plan)
├── research.md          # Phase 0 output - technology decisions
├── data-model.md        # Phase 1 output - unified data model
├── quickstart.md        # Phase 1 output - developer setup guide
├── contracts/           # Phase 1 output - CLI command contracts
│   ├── add-task.md
│   ├── view-tasks.md
│   ├── update-task.md
│   ├── mark-complete.md
│   ├── delete-task.md
│   ├── priorities-tags.md
│   ├── search-filter.md
│   ├── sort-tasks.md
│   ├── recurring-tasks.md
│   └── due-dates-reminders.md
├── 001-add-task/
│   ├── spec.md
│   └── tasks.md         # Generated by /sp.tasks
├── 002-view-tasks/
│   ├── spec.md
│   └── tasks.md
├── 003-update-task/
│   ├── spec.md
│   └── tasks.md
├── 004-mark-complete/
│   ├── spec.md
│   └── tasks.md
├── 005-delete-task/
│   ├── spec.md
│   └── tasks.md
├── 006-priorities-tags/
│   ├── spec.md
│   └── tasks.md
├── 007-search-filter/
│   ├── spec.md
│   └── tasks.md
├── 008-sort-tasks/
│   ├── spec.md
│   └── tasks.md
├── 009-recurring-tasks/
│   ├── spec.md
│   └── tasks.md
└── 010-due-dates-reminders/
    ├── spec.md
    └── tasks.md
```

### Source Code (repository root)

```text
src/
├── __init__.py
├── main.py              # Entry point, CLI setup
├── models/
│   ├── __init__.py
│   ├── task.py          # Task dataclass with all attributes
│   ├── priority.py      # Priority enum
│   ├── recurrence.py    # RecurrencePattern enum and logic
│   └── exceptions.py    # Custom exceptions
├── services/
│   ├── __init__.py
│   ├── task_service.py  # Core CRUD operations
│   ├── search_service.py # Search and filter logic
│   ├── sort_service.py  # Sorting logic
│   └── recurrence_service.py # Recurrence handling
├── cli/
│   ├── __init__.py
│   ├── commands.py      # CLI command definitions
│   ├── formatters.py    # Output formatting (colors, tables)
│   └── validators.py    # Input validation
└── lib/
    ├── __init__.py
    ├── date_parser.py   # Natural language date parsing
    └── id_generator.py  # Sequential ID generation

tests/
├── __init__.py
├── conftest.py          # Shared fixtures
├── unit/
│   ├── __init__.py
│   ├── test_models.py
│   ├── test_task_service.py
│   ├── test_search_service.py
│   ├── test_sort_service.py
│   └── test_recurrence_service.py
├── integration/
│   ├── __init__.py
│   ├── test_cli_add.py
│   ├── test_cli_view.py
│   ├── test_cli_update.py
│   ├── test_cli_complete.py
│   ├── test_cli_delete.py
│   ├── test_cli_priority_tags.py
│   ├── test_cli_search_filter.py
│   ├── test_cli_sort.py
│   ├── test_cli_recurring.py
│   └── test_cli_due_dates.py
└── contract/
    ├── __init__.py
    └── test_cli_commands.py  # CLI contract tests

docs/
├── architecture.md      # System architecture documentation
└── commands.md          # CLI command reference
```

**Structure Decision**: Single project structure chosen because:
1. Constitution mandates CLI-only for Phase 1 (no web/frontend)
2. All features share the same data model and services
3. Modular separation (models/services/cli) enables future Phase 2 migration

## Feature Dependency Graph

```text
┌─────────────────────────────────────────────────────────────┐
│                     FOUNDATION LAYER                         │
│  Task Model → ID Generator → Task Service → CLI Framework    │
└─────────────────────────────────────────────────────────────┘
                              │
        ┌─────────────────────┼─────────────────────┐
        ▼                     ▼                     ▼
┌───────────────┐    ┌───────────────┐    ┌───────────────┐
│  BASIC LEVEL  │    │  INTERMEDIATE │    │   ADVANCED    │
│   (1-5)       │    │    (6-8)      │    │    (9-10)     │
└───────────────┘    └───────────────┘    └───────────────┘
        │                     │                     │
   ┌────┴────┐           ┌────┴────┐          ┌────┴────┐
   ▼         ▼           ▼         ▼          ▼         ▼
001-Add  002-View    006-Priority 007-Search  009-Recur 010-Due
003-Update  ↓        (extends     (uses       (extends  (extends
004-Complete ↓        Task model)  Task data)  Task)    Task)
005-Delete   ↓            ↓            ↓          ↓         ↓
             └────────────┴────────────┴──────────┴─────────┘
                              ▼
                        008-Sort
                    (combines all)
```

**Implementation Order (dependency-driven):**
1. **Foundation**: Task model, ID generator, exceptions
2. **001-Add-Task**: Create tasks (enables all other features)
3. **002-View-Tasks**: Display tasks (required to verify all features)
4. **003-Update-Task**: Modify tasks
5. **004-Mark-Complete**: Toggle completion status
6. **005-Delete-Task**: Remove tasks
7. **006-Priorities-Tags**: Extend Task model, add priority/tags
8. **007-Search-Filter**: Add search/filter services
9. **010-Due-Dates-Reminders**: Add due date attributes (needed before sort/recurrence)
10. **008-Sort-Tasks**: Combine sorting logic (depends on priority, due dates)
11. **009-Recurring-Tasks**: Add recurrence logic (depends on due dates)

## Unified Data Model Summary

### Task Entity (Complete)

```python
@dataclass
class Task:
    # Core attributes (Basic Level)
    id: int                        # Unique identifier (auto-generated)
    title: str                     # Required, 1-200 chars
    description: str | None        # Optional, max 1000 chars
    is_complete: bool              # Default: False
    created_at: datetime           # Auto-set on creation

    # Organization attributes (Intermediate Level)
    priority: Priority | None      # high, medium, low (default: medium)
    tags: list[str]                # 0-10 tags, each max 50 chars

    # Scheduling attributes (Advanced Level)
    due_date: date | None          # Optional deadline date
    due_time: time | None          # Optional deadline time
    recurrence: RecurrencePattern | None  # none, daily, weekly, monthly
    recurrence_day: int | None     # Day for weekly (1-7) or monthly (1-31)

    # Computed properties
    @property
    def is_overdue(self) -> bool:
        """True if due date passed and task incomplete."""
        ...

    @property
    def due_status(self) -> DueStatus:
        """Returns: overdue, due_today, upcoming, no_due_date."""
        ...
```

### Supporting Types

```python
class Priority(Enum):
    HIGH = "high"
    MEDIUM = "medium"
    LOW = "low"

class RecurrencePattern(Enum):
    NONE = "none"
    DAILY = "daily"
    WEEKLY = "weekly"
    MONTHLY = "monthly"

class DueStatus(Enum):
    OVERDUE = "overdue"
    DUE_TODAY = "due_today"
    UPCOMING = "upcoming"
    NO_DUE_DATE = "no_due_date"
```

## CLI Command Summary

| Command | Description | Feature |
|---------|-------------|---------|
| `todo add <title> [--desc] [--priority] [--tags] [--due] [--recur]` | Create task | 001, 006, 009, 010 |
| `todo list [--status] [--priority] [--tag] [--search] [--sort] [--due]` | View/filter/sort tasks | 002, 007, 008, 010 |
| `todo update <id> [--title] [--desc] [--priority] [--tags] [--due] [--recur]` | Modify task | 003, 006, 009, 010 |
| `todo complete <id>` | Toggle completion | 004, 009 |
| `todo delete <id> [--force]` | Remove task | 005 |

## Quality Gates

All quality gates MUST pass before each feature is complete:

### Automated Checks
- ✅ `pytest` - All tests pass
- ✅ `pytest --cov` - Coverage >90%
- ✅ `mypy --strict` - No type errors
- ✅ `ruff check` - No linting errors
- ✅ `ruff format --check` - Code formatted

### Manual Reviews
- ✅ Spec requirements met (acceptance criteria)
- ✅ Constitution compliance (all 8 principles)
- ✅ Documentation complete (README, docstrings)
- ✅ Error handling for edge cases
- ✅ No YAGNI violations

## Complexity Tracking

No constitution violations requiring justification. All implementation choices align with:
- In-memory storage (no persistence layer complexity)
- Single project structure (no monorepo complexity)
- Standard library + minimal dependencies (no over-engineering)

## Risk Analysis

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| Date parsing complexity | Medium | Medium | Use `python-dateutil` for natural language parsing |
| Recurrence edge cases | Medium | High | Thorough test coverage for month boundaries |
| Performance with 10K tasks | Low | Medium | Early benchmarking, optimize only if needed |
| CLI output readability | Low | Low | Use `rich` library for formatting if needed |

## Next Steps

1. **Phase 0**: Create `research.md` with technology decisions
2. **Phase 1**: Create `data-model.md`, `contracts/`, `quickstart.md`
3. **Generate Tasks**: Run `/sp.tasks` for each feature to generate task files
4. **Implementation**: Follow TDD cycle for each feature in dependency order
